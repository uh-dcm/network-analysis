---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.18.1
  kernelspec:
    display_name: R
    language: R
    name: ir
---

```{r}
library(igraph)
```

```{r}
data <- read.csv('data/network_clustering.csv', header = F )
data <- as.matrix( data )
network <- graph_from_edgelist( data, directed = FALSE )
```

```{r}
plot( network )
```

## Community detection

See the [documentation](https://igraph.org/r/doc/communities.html) for a full list of various community detection approaches.

```{r}
cluster_leading_eigen( network )
```

```{r}
cluster_edge_betweenness( network )
```

```{r}
cluster_label_prop( network )
```

```{r}
cluster_leading_eigen( network )
```

### Using results

The call `membership` provides a numerical value indicating to which community each edge belongs to.

This detail can be used in `plot` by providing them there, but the membership could also be used - for example - as part of regression model.

```{r}
clusters <- cluster_leading_eigen( network )
V(network)$cluster <- membership( clusters )
```

```{r}
plot(clusters, network )
```

```{r}
## genering random variables
V(network)$gender <- as.factor( sample(0:1, length( V(network) ), replace = TRUE ) )
V(network)$age <- sample(18:63, length( V(network) ), replace = TRUE )
V(network)$education <- as.factor( sample(1:9, length( V(network) ), replace = TRUE ) )
```

```{r}
model <- lm( V(network)$cluster ~ V(network)$gender + V(network)$age + V(network)$education )
summary( model )
```

## Task

* move from the simple example dataset to organization x dataset
* modify the network so that different community detection algorithms lead to different outcomes

```{r}

```
