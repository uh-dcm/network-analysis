---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.18.1
  kernelspec:
    display_name: R
    language: R
    name: ir
---

## Dataset loading

This class uses information of people collaborating in organization X.
It was collected through a survey who says they are collaborating with who, thus it is _directed_ network.
It is stored in matrix format (not as edgelist like previous chapter).

```{r}
library(igraph)

data <- read.csv('data/org_x_collaboration.csv', header = F )
matrix <- as.matrix( data )

g <- graph_from_adjacency_matrix( matrix, 'directed' )
```

## Plotting the network

```{r}
plot( g )
```

## Modifying attributes

See the [documentation](https://igraph.org/r/doc/plot.common.html) for full list of attributes you may plot for vertex and edge parameters.

```{r}
V(g)$color <- 'blue'
V(g)$size <- degree(g)

E(g)$color <- 'green'
```

```{r}
plot(g)
```

### Task

* Modify the plot above so that it is ready for presentation in Organization X staff meeting.
 * Remove labels (set labels as empty)
 * Do something with the node sizes
 * Choose colors which are nicer
 * Use at least one vertex and one edge parameter not used in the example above. See the [documentation](https://igraph.org/r/doc/plot.common.html) for ideas both for vertex and edge.
 
### Real attributes

Above we only used attributes which could be detected from the network, such as `degree`.
However, these people have other attributes as well, such as if they are male or female.
(We do not have this data, but we shall fake it.)

```{r}
## generating gender attribute, that is, choose 0 or 1 to all vertex

V(g)$gender <- sample(0:1, length( V(g) ), replace = TRUE )
table( V(g)$gender )
```

## Task

* Generate at least one more such attribute for vertex and one for edges, use the code above.
* Use the new attributes to draw more visualizations from the data to explore if your attributes impact how the network is formed.

```{r}
V(g)$color <- ifelse( V(g)$gender == 1, "green", "yellow" )
```

## Layout algorithms

There are several ways to layout the network.
See the [documentation](https://igraph.org/r/doc/layout_.html) for various options.
Try different layouts and explore if you can communicate that

* Organization X is in crisis due to the two genders not mixing in sufficiently.

Change node sizes, colors etc. to help you communicate this result.

```{r}
plot( g , layout = layout_as_tree )
```

```{r}

```
